<div class="results-block">
    <%= render 'layouts/messages' %>
</div>


<% if @stock %>
<div class="card card-header results-block">
    <strong>Symbol</strong> <%= @stock[:ticker] %>
    <strong>Name</strong> <%= @stock[:name] %>
    <strong>Last Price</strong> <%= @stock[:last_price] %>
    <% if current_user.can_track_stock?(@stock[:ticker]) %>
        <%= link_to 'Add to portfolio', 
            user_stocks_path(user: current_user, ticker: @stock[:ticker]),
            method: :post, class: 'btn btn-success',
            data: { turbo: false } %>
    <% else %>
      <span class="badge badge-secondary">
        <% if current_user.stock_already_tracked?(@stock[:ticker]) %>
          Already in portfolio
        <% elsif !current_user.under_stock_limit? %>
          Stock tracking limit reached
        <% end %>
      </span>
    <% end %>
</div>
<% end %>